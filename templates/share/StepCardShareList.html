    {% extends "base.html" %}
    
    {% block title %}ã‚¹ãƒ†ãƒƒãƒ—ã‚«ãƒ¼ãƒ‰å…±æœ‰ä¸€è¦§ - ErrorMate{% endblock %}
    
    {% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/share/stepcardshare.css') }}">
    <style>
        .pagination { display: flex; list-style: none; padding: 0; justify-content: center; gap: 5px; margin-top: 20px;}
        .page-link { padding: 8px 12px; border: 1px solid #ddd; color: #333; text-decoration: none; border-radius: 4px; }
        .page-item.active .page-link { background-color: #007bff; color: white; border-color: #007bff; }
        .page-item.disabled .page-link { color: #ccc; pointer-events: none; }
    </style>
    {% endblock %}
    
    {% block content %}
    
        <!-- ã‚¿ã‚°æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="d-flex align-items-center mb-4" style="justify-content:flex-start;">
            <form class="d-flex" method="get" action="{{ url_for('share.share_step_card_list') }}">
                <input
                    type="text"
                    id="tagInput"
                    name="tag"
                    class="form-control me-2"
                    placeholder="ã‚¿ã‚°æ¤œç´¢æ¬„ï¼ˆè¤‡æ•°ã¯ã‚«ãƒ³ãƒ or ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šï¼‰"
                    style="max-width:400px;font-size:1.2rem;"
                    value="{{ keyword|e }}"
                >
                <button id="searchBtn" type="submit" class="btn btn-outline-primary" style="font-size:1.1rem;">ğŸ”</button>
            </form>
        </div>
        
        <!-- æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤º -->
        {% if keyword %}
        <div class="mb-3">
            <h5>æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ã€Œ{{ keyword|e }}ã€</h5>
        </div>
        {% endif %}
        
        <!-- ã‚«ãƒ¼ãƒ‰ä¸€è¦§ -->
        {% if matches %}
        <div class="row">
        
            {% for card in matches %}
            <div class="col-md-4 mb-4">
                <div class="help-card p-3">
                    <!-- ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆ2è¡Œã¾ã§ã§çœç•¥ï¼‰ -->
                    <h5 class="card-title text-center">{{ card.title }}</h5>
    
                    <!-- æœ¬æ–‡ã‚¨ãƒªã‚¢ -->
                    <div class="card-body">
                        <div class="info-label">ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:</div>
                        <pre class="code-box">{{ card.error_code }}</pre>
        
                        <div class="info-label">ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:</div>
                        <div class="text-box">{{ card.error_message }}</div>
                    </div>
    
                    <!-- ãƒ•ãƒƒã‚¿ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ»ã‚¿ã‚°ãƒ»ãƒœã‚¿ãƒ³ï¼‰ -->
                    <div class="card-footer">
                        <div class="meta">
                            {{ card.author.user_name }}
                            {% if card.tags %}
                            {% for t in card.tags %} #{{ t.tag_name }}{% endfor %}
                            {% endif %}
                        </div>
        
                        <div class="actions">
                            <button class="like-btn" 
                                    data-card="{{ card.card_id }}" 
                                    data-auth="{{ 1 if logged_in else 0 }}" 
                                    data-login="{{ login_url }}"
                                    aria-pressed="{{ 'true' if card.card_id in liked_ids else 'false' }}"
                                    >
                                <span class="heart">{{ 'â™¥' if card.card_id in liked_ids else 'â™¡' }}</span>
                                <span class="like-count">{{ like_counts.get(card.card_id, 0) }}</span>
                            </button>
                            <a href="{{ url_for('share.share_card_detail', card_id=card.card_id) }}" class="action-btn action-btn--info">è©³ç´°</a>
                        
                            {% if current_user.is_authenticated and current_user.role == 'teacher' %}
                                <button type="button"
                                        class="action-btn action-btn--danger js-open-delete"
                                        data-action="{{ url_for('share.admin_unshared_step_card', card_id=card.card_id) }}"
                                        data-title="{{ card.title|e }}">å…±æœ‰è§£é™¤
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        {% if current_user.is_authenticated and current_user.role == 'teacher' %}
        <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«ã¯ãƒšãƒ¼ã‚¸ã«1å€‹ã ã‘ -->
        <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">è§£é™¤ç¢ºèª</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é–‰ã˜ã‚‹"></button>
              </div>
        
              <div class="modal-body">
                <p class="mb-0">ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’å…±æœ‰è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
              </div>
        
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <form method="POST" id="deleteConfirmForm" style="display:inline;">
                  <button type="submit" class="btn btn-danger">è§£é™¤ã™ã‚‹</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        {% endif %}
        
        {% if pagination and pagination.pages > 1 %}
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
        
            <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
              <a class="page-link"
                 href="{{ url_for('share.share_step_card_list', page=pagination.prev_num, tag=keyword) }}">å‰ã¸</a>
            </li>
        
            {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
              {% if page_num %}
                <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                  <a class="page-link"
                     href="{{ url_for('share.share_step_card_list', page=page_num, tag=keyword) }}">{{ page_num }}</a>
                </li>
              {% else %}
                <li class="page-item disabled"><span class="page-link">...</span></li>
              {% endif %}
            {% endfor %}
        
            <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
              <a class="page-link"
                 href="{{ url_for('share.share_step_card_list', page=pagination.next_num, tag=keyword) }}">æ¬¡ã¸</a>
            </li>
        
          </ul>
        </nav>
        {% endif %}
    
        
        
        {% else %}
        <div class="alert alert-warning">è©²å½“ã™ã‚‹ã‚«ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div>
        {% endif %}
        

    {% endblock %}
    
    {% block extra_js %}
        <script src="{{ url_for('static', filename='js/share/step_cards.js') }}"></script>
    {% endblock %}

    
    